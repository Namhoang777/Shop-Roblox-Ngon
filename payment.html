<!-- (Thay vào cuối file payment.html trước </body>) -->
<script>
function getQuery() {
  const params = new URLSearchParams(window.location.search);
  return params.get('item') || '20k';
}

const packs = {
  '20k': { title: '20K - Acc Random (LV 1000 → Max)', price: '20K' },
  '50k': { title: '50K - Acc Max + GHM', price: '50K' },
  '100k': { title: '100K - Race V4 Max', price: '100K' },
  '500k': { title: '500K - Full VIP', price: '500K' }
};

document.addEventListener('DOMContentLoaded', function() {
  const item = getQuery();
  const info = packs[item] || packs['20k'];
  document.getElementById('info').innerHTML = `<h3>${info.title}</h3><p>Giá: <b>${info.price}</b></p><p>Giao acc trong 5-15 phút sau khi xác nhận.</p>`;
});

// Hàm lấy history từ localStorage
function readHistory() {
  try {
    const raw = localStorage.getItem('shop_acc_history');
    return raw ? JSON.parse(raw) : [];
  } catch(e) {
    return [];
  }
}

// Hàm ghi history vào localStorage
function writeHistory(arr) {
  localStorage.setItem('shop_acc_history', JSON.stringify(arr));
}

function submitForm(e) {
  e.preventDefault();
  const form = document.getElementById('confirmForm');
  const data = new FormData(form);
  const entry = {
    id: 'TX' + Date.now(), // id đơn giản
    name: (data.get('name') || '').trim(),
    phone: (data.get('phone') || '').trim(),
    note: (data.get('note') || '').trim(),
    proof: (data.get('proof') || '').trim(),
    createdAt: new Date().toISOString()
  };

  // Lưu vào localStorage
  const history = readHistory();
  history.unshift(entry); // add đầu danh sách (mới nhất lên trên)
  writeHistory(history);

  document.getElementById('result').innerText = 'Cảm ơn! Yêu cầu của bạn đã được ghi nhận. Liên hệ Zalo để xác nhận thanh toán.';
  form.reset();
}
// Tùy chọn: nút mở lịch sử
(function addHistoryLink(){
  const e = document.createElement('div');
  e.style.marginTop = '8px';
  e.innerHTML = '<a href="history.html" class="btn" style="background:#61f27b;color:#02121a;text-decoration:none;">Xem lịch sử giao dịch</a>';
  document.querySelector('main.container').appendChild(e);
})();
</script>
